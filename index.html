<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>The 2025 PM & Tech Finance Playbook (Dark Mode)</title>
    <!-- 
      Design Philosophy: Apple Developer Documentation (Dark Mode)
      - Backgrounds: True Black (#000000) for main content, Dark Gray (#1c1c1e) for sidebar.
      - Text: Off-white (#f5f5f7) for primary to reduce eye strain vs pure white.
      - Accent: Lighter, vibrant blue (#0a84ff) for visibility against dark backgrounds.
      - Borders: Subtle dark gray (#38383a).
    -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --sidebar-width: 280px;
            --sidebar-bg: #1c1c1e; /* Apple System Gray 6 Dark */
            --main-bg: #000000;
            --accent-color: #0a84ff; /* Apple Dark Mode Blue */
            --text-primary: #f5f5f7;
            --text-secondary: #86868b; /* System Gray */
            --border-color: #38383a;
            --card-bg: #1c1c1e;
            --hover-bg: rgba(255, 255, 255, 0.1);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            color: var(--text-primary);
            background-color: var(--main-bg);
            -webkit-font-smoothing: antialiased;
            overflow: hidden; /* App-like feel */
        }

        /* Custom Scrollbar for Dark Mode */
        ::-webkit-scrollbar {
            width: 12px;
            background: var(--main-bg);
        }
        ::-webkit-scrollbar-thumb {
            background-color: #38383a;
            border-radius: 6px;
            border: 3px solid var(--main-bg);
        }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background-color: var(--sidebar-bg);
            border-right: 1px solid var(--border-color);
            height: 100vh;
            position: fixed;
            left: 0;
            top: 0;
            overflow-y: auto;
            z-index: 50;
        }

        /* Main Content */
        .main-content {
            margin-left: var(--sidebar-width);
            height: 100vh;
            overflow-y: auto;
            scroll-behavior: smooth;
            background-color: var(--main-bg);
        }

        /* Typography Override */
        h1 { letter-spacing: -0.02em; color: var(--text-primary); }
        h2 { letter-spacing: -0.01em; margin-top: 2.5rem; margin-bottom: 1rem; color: var(--text-primary); }
        h3 { margin-top: 1.5rem; margin-bottom: 0.5rem; color: #fff; }
        p, li { line-height: 1.6; color: #d1d1d6; margin-bottom: 1.2rem; }
        strong { color: #fff; font-weight: 600; }
        
        /* Interactive "Read" Checkbox */
        .read-toggle {
            appearance: none;
            width: 20px;
            height: 20px;
            border: 2px solid #636366;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            background-color: transparent;
            top: 4px;
        }
        .read-toggle:checked {
            background-color: var(--accent-color);
            border-color: var(--accent-color);
        }
        .read-toggle:checked::after {
            content: 'âœ“';
            color: white;
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            font-size: 12px;
            font-weight: 700;
        }

        /* Pro Tip / Note Box */
        .callout {
            background-color: #1c1c1e; /* Card BG */
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border: 1px solid #38383a;
            border-left: 4px solid var(--accent-color);
        }

        /* Navigation Item Styling */
        .nav-group-title {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-secondary);
            margin: 24px 20px 8px 20px;
            letter-spacing: 0.05em;
        }
        .nav-item {
            display: flex;
            align-items: center;
            padding: 8px 20px;
            font-size: 13px;
            font-weight: 500;
            color: #98989d;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.1s ease;
            border-radius: 6px;
            margin: 0 8px;
        }
        .nav-item:hover {
            color: #fff;
            background-color: var(--hover-bg);
        }
        .nav-item.active {
            color: var(--accent-color);
            background: rgba(10, 132, 255, 0.15);
        }

        /* Progress Bar (Sticky Header) */
        .progress-header {
            position: sticky;
            top: 0;
            background: rgba(0,0,0,0.85); /* Dark Blur */
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            z-index: 40;
            border-bottom: 1px solid var(--border-color);
        }

        /* Mobile Header */
        .mobile-header {
            background-color: rgba(28, 28, 30, 0.9);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-color);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar { transform: translateX(-100%); transition: transform 0.3s ease; }
            .sidebar.open { transform: translateX(0); }
            .main-content { margin-left: 0; }
        }
    </style>
</head>
<body>

    <!-- Mobile Menu Toggle -->
    <div class="md:hidden mobile-header fixed top-0 left-0 w-full h-14 z-50 flex items-center px-4 justify-between">
        <span class="font-semibold text-white">PM Playbook</span>
        <button id="menu-btn" class="p-2 text-gray-400 hover:text-white">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
        </button>
    </div>

    <!-- Sidebar Navigation -->
    <nav id="sidebar" class="sidebar flex flex-col pt-14 md:pt-6 pb-10">
        <div class="px-5 mb-6">
            <h1 class="text-xl font-bold tracking-tight text-white">The 2025 Playbook</h1>
            <p class="text-xs text-gray-400 mt-1">Deep Research Edition</p>
        </div>

        <div id="nav-container">
            <!-- Nav Items Injected JS -->
        </div>

        <div class="mt-auto px-5 pt-6 border-t border-[#38383a]">
            <div class="flex items-center justify-between text-xs font-medium text-gray-400 mb-2">
                <span>Knowledge Mastery</span>
                <span id="global-percent">0%</span>
            </div>
            <div class="w-full bg-[#38383a] rounded-full h-1.5">
                <div id="global-bar" class="bg-[#0a84ff] h-1.5 rounded-full shadow-[0_0_10px_rgba(10,132,255,0.5)]" style="width: 0%"></div>
            </div>
            <button onclick="resetProgress()" class="text-[10px] text-gray-500 mt-3 hover:text-red-400 transition-colors w-full text-left">Reset Progress</button>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main class="main-content relative">
        <!-- Sticky Header within Content -->
        <div class="progress-header px-8 py-4 flex items-center justify-between">
            <div id="current-section-title" class="text-sm font-semibold text-gray-400">Select a Topic</div>
            <div class="text-xs text-gray-500">
                <span id="section-progress" class="text-gray-300">0/0</span> Topics Mastered
            </div>
        </div>

        <!-- Content Container -->
        <div id="content-area" class="max-w-4xl mx-auto px-6 md:px-12 py-10 pb-24">
            <!-- Dynamic Content Injected Here -->
        </div>
    </main>

    <script>
        // --- 1. THE DEEP RESEARCH CONTENT DATABASE ---
        // Full Content Preserved
        
        const fullContent = {
            "p1_rag": {
                title: "RAG & Agentic AI",
                category: "Product & AI",
                sections: [
                    {
                        header: "Technical Foundations of RAG",
                        content: `
                            <p>Retrieval-Augmented Generation (RAG) is the dominant architecture for Enterprise AI in 2025. Unlike a standard LLM which relies solely on its pre-trained memory (which cuts off at a specific date), RAG connects the model to live, private data.</p>
                            
                            <h3>The Architecture Pipeline</h3>
                            <p>To scope a RAG product, you must understand the three-step flow:</p>
                            <ul class="list-disc pl-5 space-y-2 mb-4 text-gray-400 text-sm">
                                <li><strong class="text-gray-200">Ingestion:</strong> Documents are sliced into small "chunks" (paragraphs or sentences).</li>
                                <li><strong class="text-gray-200">Retrieval:</strong> When a user asks a question, the system searches the chunks for relevant info using "Vector Embeddings".</li>
                                <li><strong class="text-gray-200">Generation:</strong> The system sends the user's question + the retrieved chunks to the LLM to generate an answer.</li>
                            </ul>
                            
                            <div class="callout">
                                <strong class="text-white">PM Takeaway:</strong> The quality of a RAG system is usually limited by the <em>Retrieval</em> step, not the Generation step. If the system can't find the right document, GPT-4 cannot answer the question.
                            </div>

                            <h3>Vector Databases & Embeddings</h3>
                            <p>Computers don't understand meaning; they understand numbers. <strong>Embedding Models</strong> (like OpenAI's text-embedding-3) convert text into long lists of numbers (vectors). Text with similar meaning ends up with similar numbers.</p>
                            <p><strong>Vector Databases</strong> (Pinecone, Milvus, Weaviate) are specialized databases built to store these numbers and perform "Similarity Search" incredibly fast. They are the long-term memory of your AI application.</p>
                        `
                    },
                    {
                        header: "Defining Agentic AI",
                        content: `
                            <p>In 2025, we shifted from "Chatbots" to "Agents". A Chatbot waits for a user to type. An <strong>Agent</strong> has goals and can execute actions to achieve them.</p>
                            
                            <h3>Core Characteristics</h3>
                            <ul class="list-disc pl-5 space-y-2 mb-4 text-gray-400 text-sm">
                                <li><strong class="text-gray-200">Tool Use:</strong> The ability to call functions (APIs, Calculator, Web Search).</li>
                                <li><strong class="text-gray-200">Reasoning Loops (ReAct):</strong> The agent thinks: <em>"Thought: I need weather data. Action: Call Weather API. Observation: It is raining."</em></li>
                                <li><strong class="text-gray-200">Planning:</strong> Breaking a vague request ("Book my trip") into sub-tasks (Flights, Hotels, Calendar).</li>
                            </ul>

                            <h3>Multi-Agent Systems</h3>
                            <p>Frameworks like <strong>CrewAI</strong> allow you to create a team of specialized agents (e.g., a "Researcher" agent finds data, a "Writer" agent drafts the email). This separation of concerns reduces hallucination and improves complex task performance.</p>
                        `
                    },
                    {
                        header: "Production & PM Considerations",
                        content: `
                            <p>Moving from a demo to production is the hardest phase. PMs must track specific metrics beyond "it feels good."</p>
                            
                            <h3>The "RAG Triad" Metrics</h3>
                            <ul class="list-disc pl-5 space-y-2 mb-4 text-gray-400 text-sm">
                                <li><strong class="text-gray-200">Context Relevance:</strong> Did we retrieve the right chunk? (Retrieval Metric)</li>
                                <li><strong class="text-gray-200">Groundedness:</strong> Did the answer rely <em>only</em> on the retrieved chunk? (Hallucination Metric)</li>
                                <li><strong class="text-gray-200">Answer Relevance:</strong> Did the final answer actually help the user? (Product Metric)</li>
                            </ul>
                            
                            <div class="callout">
                                <strong class="text-white">Cost Strategy:</strong> Vector search is cheap. LLM generation is expensive. Use "Caching" to store answers to common questions to reduce API costs by 40-60%.
                            </div>
                        `
                    }
                ]
            },
            "p1_tech": {
                title: "PM Tech Skills 2025",
                category: "Product & AI",
                sections: [
                    {
                        header: "AI/ML Literacy for PMs",
                        content: `
                            <p>You don't need to code the model, but you must understand its constraints. The biggest trade-off decision in 2025 is <strong>Fine-Tuning vs. RAG</strong>.</p>
                            <ul class="list-disc pl-5 space-y-2 mb-4 text-gray-400 text-sm">
                                <li><strong class="text-gray-200">RAG:</strong> Use when the model needs to know <em>facts</em> (company wiki, user data). It is cheaper and easier to update.</li>
                                <li><strong class="text-gray-200">Fine-Tuning:</strong> Use when the model needs to learn a <em>style</em>, <em>format</em>, or highly specific <em>language</em> (e.g., medical coding). It does NOT teach new facts well.</li>
                            </ul>
                            <p><strong>Prompt Engineering:</strong> This is now a core PM skill. Understanding "Few-Shot Prompting" (giving the model examples) is often more effective than months of engineering work.</p>
                        `
                    },
                    {
                        header: "Data & Analytics Mastery",
                        content: `
                            <p>In AI products, standard A/B testing fails because the output is non-deterministic (it changes every time). PMs must learn <strong>"Golden Set Evaluation"</strong>.</p>
                            <p>Create a dataset of 100 "perfect" question-answer pairs (The Golden Set). Every time engineering updates the prompt or model, run these 100 questions and score the AI's answers against your Golden Set. This is your regression test.</p>
                            <div class="callout">
                                <strong class="text-white">Key Metric:</strong> <em>Acceptance Rate</em>. In Copilot tools, how often does the user hit "Tab" to accept the suggestion? This is the ultimate measure of utility.
                            </div>
                        `
                    },
                    {
                        header: "AI-Enhanced Development",
                        content: `
                            <p>Tools like <strong>GitHub Copilot</strong> and <strong>Cursor</strong> have changed the velocity of engineering. A task that took 4 hours might now take 30 minutes.</p>
                            <p><strong>PM Implication:</strong> Be wary of "Velocity Inflation." Teams generate code faster, but reviewing and testing that code (QA) becomes the bottleneck. Shift your timeline expectations: Coding is fast, Debugging/QA is slow.</p>
                        `
                    }
                ]
            },
            "p1_biz": {
                title: "PM Business Skills 2025",
                category: "Product & AI",
                sections: [
                    {
                        header: "AI Business Models",
                        content: `
                            <p>Monetizing AI is tricky due to high variable costs (GPU compute). We are seeing a shift away from pure flat-rate SaaS.</p>
                            <h3>Emerging Models</h3>
                            <ul class="list-disc pl-5 space-y-2 mb-4 text-gray-400 text-sm">
                                <li><strong class="text-gray-200">Token-Pass-Through:</strong> Enterprise pays a base fee + their own OpenAI API bill.</li>
                                <li><strong class="text-gray-200">Outcome-Based Pricing:</strong> Don't charge for the software; charge for the result. (e.g., Intercom charging per <em>resolved</em> support ticket, not per seat).</li>
                                <li><strong class="text-gray-200">Hybrid Freemium:</strong> The "dumb" features are free; the "agentic" features are paid.</li>
                            </ul>
                        `
                    },
                    {
                        header: "Strategy & Moats",
                        content: `
                            <p>Does your AI product have a moat? <strong>The model itself is NOT a moat.</strong> OpenAI and Anthropic will commoditize intelligence.</p>
                            <p><strong>The Real Moats in 2025:</strong></p>
                            <ul class="list-disc pl-5 space-y-2 mb-4 text-gray-400 text-sm">
                                <li><strong class="text-gray-200">Proprietary Data:</strong> Data that no one else has to feed into RAG.</li>
                                <li><strong class="text-gray-200">Workflow Integration:</strong> Being deeply embedded in the user's daily habits (the "System of Record").</li>
                                <li><strong class="text-gray-200">UX/Trust:</strong> The user trusts <em>your</em> agent to execute the trade/send the email.</li>
                            </ul>
                        `
                    }
                ]
            },
            "p2_fund": {
                title: "Financial Fundamentals",
                category: "Tech Finance",
                sections: [
                    {
                        header: "Valuation Metrics",
                        content: `
                            <p>To talk to Execs, you must speak Finance. The most common metric for SaaS is the <strong>Rule of 40</strong>.</p>
                            <p><strong>Rule of 40:</strong> Your Annual Growth Rate (%) + Your Profit Margin (%) should equal 40 or higher. <br><em>Example:</em> If you grow 100% YoY, you can burn 60% margin (unprofitable) and still be "healthy" (100 - 60 = 40).</p>
                            <p><strong>EV/EBITDA:</strong> Used for mature companies. Enterprise Value divided by Earnings Before Interest, Taxes, Depreciation, Amortization. It roughly means "how many years of current profit would it take to buy the company?"</p>
                        `
                    },
                    {
                        header: "Equity & Cap Tables",
                        content: `
                            <p>Understanding your comp package requires knowing the difference between <strong>Preferred</strong> and <strong>Common</strong> stock.</p>
                            <ul class="list-disc pl-5 space-y-2 mb-4 text-gray-400 text-sm">
                                <li><strong class="text-gray-200">Liquidation Preference:</strong> Investors (Preferred) usually get paid back 1x their money <em>before</em> employees (Common) see a dime. In a "down round" or poor exit, employees can end up with $0 even if the company sells for millions.</li>
                                <li><strong class="text-gray-200">409A Valuation:</strong> The "Fair Market Value" of the stock, determined by a third party. This sets the "Strike Price" for your options. You want this to be low (for cheap buy-in) while the investor valuation is high.</li>
                            </ul>
                        `
                    }
                ]
            },
            "p2_econ": {
                title: "Company Economics",
                category: "Tech Finance",
                sections: [
                    {
                        header: "SaaS Metrics Deep Dive",
                        content: `
                            <p><strong class="text-gray-200">NDR (Net Dollar Retention):</strong> The holy grail. If you stopped acquiring new customers today, would your revenue grow or shrink? <br><em>Calculation:</em> (Starting ARR + Upgrades - Downgrades - Churn) / Starting ARR. <br>Top tier companies have >120% NDR.</p>
                            <p><strong class="text-gray-200">CAC Payback Period:</strong> How many months of paying us does it take for a customer to pay back the cost of the Sales & Marketing used to get them? <br><em>Target:</em> < 12 months for SMB, < 18 months for Enterprise.</p>
                        `
                    },
                    {
                        header: "Marketplace Metrics",
                        content: `
                            <p>Marketplaces (Uber, Airbnb) live and die by <strong>Liquidity</strong> (the probability of a match). High liquidity creates a flywheel.</p>
                            <p><strong class="text-gray-200">Take Rate:</strong> The % the platform keeps. App Store is 30% (High). Uber is ~25%. Marketplaces with lower take rates often defend against "disintermediation" (users taking the deal off-platform) better.</p>
                        `
                    }
                ]
            },
            "p2_invest": {
                title: "Investment Landscape",
                category: "Tech Finance",
                sections: [
                    {
                        header: "The Power Law",
                        content: `
                            <p>Venture Capital is driven by the <strong>Power Law</strong>. Returns are not normally distributed.</p>
                            <div class="callout">
                                In a fund of 100 companies, 1 company will likely return the entire value of the fund. 5 will do okay. 94 will fail or break even.
                            </div>
                            <p>This explains VC behavior: They swing for home runs (100x returns) and ignore singles (3x returns). As a founder or PM, you need to articulate how your product can become a "fund returner" (Billion dollar outcome).</p>
                        `
                    },
                    {
                        header: "Major Players",
                        content: `
                            <p><strong class="text-gray-200">Sequoia:</strong> The gold standard. Known for "market making" and sticking with companies for decades (Apple, Google, Nvidia).</p>
                            <p><strong class="text-gray-200">Andreessen Horowitz (a16z):</strong> The "Agency" model. They provide massive operational support (marketing, talent) but take high fees. Famous for "Software is Eating the World."</p>
                            <p><strong class="text-gray-200">Tiger Global:</strong> The "Velocity" model. They invest fast, do less diligence, and pay high prices, treating startups like an index fund asset class.</p>
                        `
                    }
                ]
            },
            "p2_read": {
                title: "Reading the Ecosystem",
                category: "Tech Finance",
                sections: [
                    {
                        header: "Sources & Signals",
                        content: `
                            <p><strong class="text-gray-200">Stratechery (Ben Thompson):</strong> Essential for "Aggregation Theory" and platform strategy.</p>
                            <p><strong class="text-gray-200">The Information:</strong> The best source for org-chart drama and actual revenue numbers (before they are public).</p>
                            <p><strong class="text-gray-200">Hacker News (Y Combinator):</strong> The raw sentiment of the engineering class. If you want to know if a dev tool is actually good, look here, not on Gartner.</p>
                        `
                    },
                    {
                        header: "Earnings Calls",
                        content: `
                            <p>Don't just look at the stock price. Read the <strong>Transcript</strong>. Look for "Guidance" (what they predict for next quarter). <br>If a company beats earnings (made more money than expected) but lowers guidance (expects to make less next time), the stock will crash. Markets trade on the <em>future</em>, not the past.</p>
                        `
                    }
                ]
            },
            "p2_conv": {
                title: "The Tech Conversation",
                category: "Tech Finance",
                sections: [
                    {
                        header: "Interview & Networking",
                        content: `
                            <p><strong class="text-gray-200">The Contrarian Take:</strong> In interviews, you will often be asked "What do you believe that few others do?" (Thiel question). <br><em>Good Answer Strategy:</em> Pick a structural shift. "I believe LLMs will make the 'Seat-based' SaaS pricing model obsolete by 2026, forcing a shift to outcome-based billing."</p>
                            <p><strong class="text-gray-200">Case Math:</strong> PM interviews often ask for estimation. "How much storage does Gmail need?" <br><em>Tip:</em> Memorize the powers of 10. <br>1 Million users x 1 GB = 1 Petabyte. <br>Knowing your "Tech Finance" numbers (AWS costs, storage costs) makes you look like a CTO-level thinker.</p>
                        `
                    }
                ]
            }
        };

        // --- 2. APP LOGIC ---

        const navContainer = document.getElementById('nav-container');
        const contentArea = document.getElementById('content-area');
        const currentSectionTitle = document.getElementById('current-section-title');
        const sectionProgress = document.getElementById('section-progress');
        const globalPercent = document.getElementById('global-percent');
        const globalBar = document.getElementById('global-bar');
        const menuBtn = document.getElementById('menu-btn');
        const sidebar = document.getElementById('sidebar');

        let activeKey = null;

        function init() {
            renderNav();
            // Load first item by default
            const firstKey = Object.keys(fullContent)[0];
            loadSection(firstKey);
            updateProgress();
        }

        function renderNav() {
            let currentCategory = "";
            let html = "";
            
            for (const [key, data] of Object.entries(fullContent)) {
                if (data.category !== currentCategory) {
                    html += `<div class="nav-group-title">${data.category}</div>`;
                    currentCategory = data.category;
                }
                html += `
                    <div id="nav-${key}" class="nav-item" onclick="loadSection('${key}')">
                        ${data.title}
                    </div>
                `;
            }
            navContainer.innerHTML = html;
        }

        window.loadSection = (key) => {
            activeKey = key;
            const data = fullContent[key];
            
            // Highlight Nav
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            document.getElementById(`nav-${key}`).classList.add('active');

            // Set Header
            currentSectionTitle.innerText = data.title;

            // Render Content
            let html = `
                <div class="mb-10">
                    <h1 class="text-4xl font-bold mb-4 tracking-tight">${data.title}</h1>
                    <div class="h-1 w-20 bg-[#38383a] rounded"></div>
                </div>
            `;

            data.sections.forEach((section, index) => {
                const itemId = `chk_${key}_${index}`;
                const isChecked = localStorage.getItem(itemId) === 'true' ? 'checked' : '';

                html += `
                    <div class="mb-12 animate-fade-in" style="animation-delay: ${index * 0.1}s">
                        <div class="flex items-baseline justify-between mb-4 border-b border-[#38383a] pb-2">
                            <h2 class="text-2xl font-semibold text-white m-0 p-0">${section.header}</h2>
                            <label class="flex items-center space-x-2 cursor-pointer group">
                                <span class="text-xs text-gray-500 group-hover:text-gray-300 font-medium">Mark Read</span>
                                <input type="checkbox" class="read-toggle" id="${itemId}" ${isChecked} onchange="toggleRead('${itemId}')">
                            </label>
                        </div>
                        <div class="prose prose-lg text-gray-400 max-w-none">
                            ${section.content}
                        </div>
                    </div>
                `;
            });

            contentArea.innerHTML = html;
            
            // Scroll top
            document.querySelector('.main-content').scrollTop = 0;
            
            // Mobile: Close sidebar
            sidebar.classList.remove('open');
            
            updateSectionProgress();
        };

        window.toggleRead = (id) => {
            const el = document.getElementById(id);
            localStorage.setItem(id, el.checked);
            updateProgress();
            updateSectionProgress();
        };

        function updateSectionProgress() {
            if (!activeKey) return;
            const data = fullContent[activeKey];
            let total = data.sections.length;
            let checked = 0;
            
            data.sections.forEach((_, index) => {
                if (localStorage.getItem(`chk_${activeKey}_${index}`) === 'true') checked++;
            });
            
            sectionProgress.innerText = `${checked}/${total}`;
        }

        function updateProgress() {
            let total = 0;
            let checked = 0;
            
            for (const [key, data] of Object.entries(fullContent)) {
                data.sections.forEach((_, index) => {
                    total++;
                    if (localStorage.getItem(`chk_${key}_${index}`) === 'true') checked++;
                });
            }
            
            const percent = total === 0 ? 0 : Math.round((checked / total) * 100);
            globalPercent.innerText = `${percent}%`;
            globalBar.style.width = `${percent}%`;
        }

        window.resetProgress = () => {
            if(confirm('Reset all reading progress?')) {
                localStorage.clear();
                location.reload();
            }
        };

        // Mobile Menu Logic
        menuBtn.addEventListener('click', () => {
            sidebar.classList.toggle('open');
        });

        // Close sidebar on outside click
        document.addEventListener('click', (e) => {
            if (window.innerWidth < 768 && 
                !sidebar.contains(e.target) && 
                !menuBtn.contains(e.target) &&
                sidebar.classList.contains('open')) {
                sidebar.classList.remove('open');
            }
        });

        // CSS Animation for Fade In
        const style = document.createElement('style');
        style.innerHTML = `
            @keyframes fadeIn {
                from { opacity: 0; transform: translateY(10px); }
                to { opacity: 1; transform: translateY(0); }
            }
            .animate-fade-in {
                animation: fadeIn 0.5s ease forwards;
                opacity: 0;
            }
        `;
        document.head.appendChild(style);

        // Run
        init();

    </script>
</body>
</html>
