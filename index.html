<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>The 2025 Playbook | Midnight Edition</title>
    
    <!-- 
      AESTHETIC: "Midnight Cupertino"
      - True Black backgrounds with Zinc-900 contrasts.
      - Glassmorphism (backdrop-blur) for depth.
      - Subtle gradients (Blue/Purple) for active states to add "Beauty".
      - High-fidelity typography (Inter tight/tracking).
      - Content: FULL Deep Research Text retained.
    -->

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        midnight: '#000000',
                        glass: 'rgba(28, 28, 30, 0.7)',
                        'glass-border': 'rgba(255, 255, 255, 0.08)',
                        accent: '#2997ff', // Apple Blue
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards',
                        'slide-up': 'slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideUp: {
                            '0%': { opacity: '0', transform: 'translateY(20px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>
    
    <style>
        /* Base Polish */
        body {
            background-color: #000000;
            color: #f5f5f7;
            -webkit-font-smoothing: antialiased;
            overflow: hidden;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
            background: #000000;
        }
        ::-webkit-scrollbar-thumb {
            background: #333;
            border-radius: 3px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* Glassmorphism Utilities */
        .glass-panel {
            background: rgba(28, 28, 30, 0.6);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border-right: 1px solid rgba(255, 255, 255, 0.08);
        }
        
        .glass-card {
            background: linear-gradient(180deg, rgba(30, 30, 32, 0.8) 0%, rgba(20, 20, 22, 0.8) 100%);
            border: 1px solid rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(10px);
            transition: transform 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
        }
        
        .glass-card:hover {
            border-color: rgba(41, 151, 255, 0.3);
            box-shadow: 0 0 30px rgba(0,0,0,0.5);
            transform: translateY(-2px);
        }

        /* Typography Hierarchy */
        h1, h2, h3 { letter-spacing: -0.025em; }
        p { color: #a1a1a6; line-height: 1.7; font-weight: 300; }
        strong { color: #fff; font-weight: 600; }
        
        /* Navigation Active State */
        .nav-item.active {
            background: linear-gradient(90deg, rgba(41, 151, 255, 0.15) 0%, transparent 100%);
            border-left: 3px solid #2997ff;
            color: #fff;
        }

        /* Progress Bar Gradient */
        .progress-gradient {
            background: linear-gradient(90deg, #2997ff, #bf5af2);
        }

        /* Mobile Adjustments */
        @media (max-width: 768px) {
            .sidebar { transform: translateX(-100%); transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
            .sidebar.open { transform: translateX(0); }
        }
    </style>
</head>
<body class="flex h-screen w-full">

    <!-- Mobile Header -->
    <div class="md:hidden fixed top-0 w-full h-16 z-50 glass-panel border-b border-white/10 flex items-center justify-between px-6">
        <span class="font-bold text-lg tracking-tight">Playbook '25</span>
        <button id="menu-btn" class="text-white">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
        </button>
    </div>

    <!-- Sidebar -->
    <aside id="sidebar" class="sidebar fixed md:relative z-40 w-72 h-full glass-panel flex flex-col pt-20 md:pt-10 pb-6 shrink-0">
        <!-- Brand -->
        <div class="px-8 mb-10">
            <h1 class="text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-purple-400">
                The Second Brain
            </h1>
            <p class="text-xs text-gray-500 font-medium mt-1 tracking-widest uppercase">PM & Finance Masterclass</p>
        </div>

        <!-- Navigation Container -->
        <div id="nav-container" class="flex-1 overflow-y-auto px-4 space-y-1">
            <!-- Injected via JS -->
        </div>

        <!-- User Progress Footer -->
        <div class="px-8 pt-6 mt-4 border-t border-white/5">
            <div class="flex justify-between items-end mb-2">
                <span class="text-xs font-semibold text-gray-400 uppercase tracking-wider">Mastery</span>
                <span id="global-percent" class="text-sm font-bold text-white">0%</span>
            </div>
            <div class="w-full h-1 bg-gray-800 rounded-full overflow-hidden">
                <div id="global-bar" class="h-full progress-gradient transition-all duration-700 ease-out" style="width: 0%"></div>
            </div>
            <button onclick="resetProgress()" class="mt-4 text-[10px] text-gray-600 hover:text-red-500 transition-colors">Reset Progress</button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 h-full overflow-y-auto relative bg-midnight selection:bg-blue-500/30">
        
        <!-- Ambient Background Glow -->
        <div class="fixed top-0 right-0 w-[500px] h-[500px] bg-blue-900/10 rounded-full blur-[120px] pointer-events-none"></div>
        <div class="fixed bottom-0 left-0 w-[500px] h-[500px] bg-purple-900/10 rounded-full blur-[120px] pointer-events-none"></div>

        <!-- Sticky Content Header -->
        <div class="sticky top-0 z-30 bg-black/80 backdrop-blur-xl border-b border-white/5 px-8 py-5 flex items-center justify-between">
            <div>
                <h2 id="header-title" class="text-sm font-semibold text-white tracking-wide">Overview</h2>
                <p id="header-subtitle" class="text-xs text-gray-500">Select a topic to begin deep research</p>
            </div>
            <div class="text-xs font-mono text-gray-600 bg-white/5 px-3 py-1 rounded-full border border-white/5">
                <span id="section-counter">0/0</span> READ
            </div>
        </div>

        <!-- Content Body -->
        <div id="content-area" class="max-w-4xl mx-auto px-6 md:px-12 py-12 pb-32 relative z-10">
            <!-- Dynamic Content Injected Here -->
        </div>

    </main>

    <script>
        // --- DEEP RESEARCH CONTENT (Full Fidelity) ---
        // Retaining the expanded text from the previous iteration.
        
        const fullContent = {
            "p1_rag": {
                title: "RAG & Agentic AI",
                category: "Product & AI",
                subtitle: "Architecture, production metrics, and the shift to autonomy.",
                sections: [
                    {
                        header: "Technical Foundations of RAG",
                        content: `
                            <p>Retrieval-Augmented Generation (RAG) is the dominant architecture for Enterprise AI in 2025. Unlike a standard LLM which relies solely on its pre-trained memory (which cuts off at a specific date), RAG connects the model to live, private data.</p>
                            
                            <h3 class="text-white text-lg font-semibold mt-6 mb-3">The Architecture Pipeline</h3>
                            <p>To scope a RAG product, you must understand the three-step flow:</p>
                            <ul class="list-none space-y-3 mt-4 mb-6">
                                <li class="flex gap-3"><span class="text-accent">01.</span> <span class="text-gray-300"><strong>Ingestion:</strong> Documents are sliced into small "chunks" (paragraphs or sentences).</span></li>
                                <li class="flex gap-3"><span class="text-accent">02.</span> <span class="text-gray-300"><strong>Retrieval:</strong> When a user asks a question, the system searches the chunks for relevant info using "Vector Embeddings".</span></li>
                                <li class="flex gap-3"><span class="text-accent">03.</span> <span class="text-gray-300"><strong>Generation:</strong> The system sends the user's question + the retrieved chunks to the LLM to generate an answer.</span></li>
                            </ul>
                            
                            <div class="bg-blue-500/10 border border-blue-500/20 p-5 rounded-xl">
                                <p class="text-blue-200 text-sm mb-0"><strong>PM Takeaway:</strong> The quality of a RAG system is usually limited by the <em>Retrieval</em> step, not the Generation step. If the system can't find the right document, GPT-4 cannot answer the question.</p>
                            </div>

                            <h3 class="text-white text-lg font-semibold mt-8 mb-3">Vector Databases & Embeddings</h3>
                            <p>Computers don't understand meaning; they understand numbers. <strong>Embedding Models</strong> (like OpenAI's text-embedding-3) convert text into long lists of numbers (vectors). Text with similar meaning ends up with similar numbers. <strong>Vector Databases</strong> (Pinecone, Milvus, Weaviate) are specialized databases built to store these numbers and perform "Similarity Search" incredibly fast. They are the long-term memory of your AI application.</p>
                        `
                    },
                    {
                        header: "Defining Agentic AI",
                        content: `
                            <p>In 2025, we shifted from "Chatbots" to "Agents". A Chatbot waits for a user to type. An <strong>Agent</strong> has goals and can execute actions to achieve them.</p>
                            
                            <h3 class="text-white text-lg font-semibold mt-6 mb-3">Core Characteristics</h3>
                            <ul class="list-disc list-inside space-y-2 text-gray-400 marker:text-gray-600">
                                <li><strong>Tool Use:</strong> The ability to call functions (APIs, Calculator, Web Search).</li>
                                <li><strong>Reasoning Loops (ReAct):</strong> The agent thinks: <em>"Thought: I need weather data. Action: Call Weather API. Observation: It is raining."</em></li>
                                <li><strong>Planning:</strong> Breaking a vague request ("Book my trip") into sub-tasks (Flights, Hotels, Calendar).</li>
                            </ul>

                            <h3 class="text-white text-lg font-semibold mt-6 mb-3">Multi-Agent Systems</h3>
                            <p>Frameworks like <strong>CrewAI</strong> allow you to create a team of specialized agents (e.g., a "Researcher" agent finds data, a "Writer" agent drafts the email). This separation of concerns reduces hallucination and improves complex task performance.</p>
                        `
                    },
                    {
                        header: "Production & PM Considerations",
                        content: `
                            <p>Moving from a demo to production is the hardest phase. PMs must track specific metrics beyond "it feels good."</p>
                            
                            <h3 class="text-white text-lg font-semibold mt-6 mb-3">The "RAG Triad" Metrics</h3>
                            <ul class="list-disc list-inside space-y-2 text-gray-400 marker:text-gray-600">
                                <li><strong>Context Relevance:</strong> Did we retrieve the right chunk? (Retrieval Metric)</li>
                                <li><strong>Groundedness:</strong> Did the answer rely <em>only</em> on the retrieved chunk? (Hallucination Metric)</li>
                                <li><strong>Answer Relevance:</strong> Did the final answer actually help the user? (Product Metric)</li>
                            </ul>
                            
                            <div class="mt-4 bg-zinc-900 border border-zinc-800 p-5 rounded-xl">
                                <p class="text-gray-300 text-sm mb-0"><strong>Cost Strategy:</strong> Vector search is cheap. LLM generation is expensive. Use "Caching" to store answers to common questions to reduce API costs by 40-60%.</p>
                            </div>
                        `
                    }
                ]
            },
            "p1_tech": {
                title: "PM Tech Skills 2025",
                category: "Product & AI",
                subtitle: "Fine-tuning, Evaluation sets, and the new dev stack.",
                sections: [
                    {
                        header: "AI/ML Literacy for PMs",
                        content: `
                            <p>You don't need to code the model, but you must understand its constraints. The biggest trade-off decision in 2025 is <strong>Fine-Tuning vs. RAG</strong>.</p>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 my-6">
                                <div class="bg-white/5 p-4 rounded-lg border border-white/10">
                                    <strong class="text-accent block mb-2">RAG</strong>
                                    <span class="text-sm">Use when the model needs to know <em>facts</em> (company wiki, user data). It is cheaper and easier to update.</span>
                                </div>
                                <div class="bg-white/5 p-4 rounded-lg border border-white/10">
                                    <strong class="text-purple-400 block mb-2">Fine-Tuning</strong>
                                    <span class="text-sm">Use when the model needs to learn a <em>style</em>, <em>format</em>, or highly specific <em>language</em> (e.g., medical coding). It does NOT teach new facts well.</span>
                                </div>
                            </div>
                            <p><strong>Prompt Engineering:</strong> This is now a core PM skill. Understanding "Few-Shot Prompting" (giving the model examples) is often more effective than months of engineering work.</p>
                        `
                    },
                    {
                        header: "Data & Analytics Mastery",
                        content: `
                            <p>In AI products, standard A/B testing fails because the output is non-deterministic (it changes every time). PMs must learn <strong>"Golden Set Evaluation"</strong>.</p>
                            <p>Create a dataset of 100 "perfect" question-answer pairs (The Golden Set). Every time engineering updates the prompt or model, run these 100 questions and score the AI's answers against your Golden Set. This is your regression test.</p>
                            <div class="mt-4 bg-zinc-900 border border-zinc-800 p-5 rounded-xl">
                                <strong class="text-white block mb-1">Key Metric: Acceptance Rate</strong> 
                                <span class="text-sm">In Copilot tools, how often does the user hit "Tab" to accept the suggestion? This is the ultimate measure of utility.</span>
                            </div>
                        `
                    },
                    {
                        header: "AI-Enhanced Development",
                        content: `
                            <p>Tools like <strong>GitHub Copilot</strong> and <strong>Cursor</strong> have changed the velocity of engineering. A task that took 4 hours might now take 30 minutes.</p>
                            <p><strong>PM Implication:</strong> Be wary of "Velocity Inflation." Teams generate code faster, but reviewing and testing that code (QA) becomes the bottleneck. Shift your timeline expectations: Coding is fast, Debugging/QA is slow.</p>
                        `
                    }
                ]
            },
            "p1_biz": {
                title: "PM Business Skills 2025",
                category: "Product & AI",
                subtitle: "Pricing, Strategy, and Moats in the age of AI.",
                sections: [
                    {
                        header: "AI Business Models",
                        content: `
                            <p>Monetizing AI is tricky due to high variable costs (GPU compute). We are seeing a shift away from pure flat-rate SaaS.</p>
                            <h3 class="text-white text-lg font-semibold mt-6 mb-3">Emerging Models</h3>
                            <ul class="list-disc list-inside space-y-2 text-gray-400 marker:text-gray-600">
                                <li><strong>Token-Pass-Through:</strong> Enterprise pays a base fee + their own OpenAI API bill.</li>
                                <li><strong>Outcome-Based Pricing:</strong> Don't charge for the software; charge for the result. (e.g., Intercom charging per <em>resolved</em> support ticket, not per seat).</li>
                                <li><strong>Hybrid Freemium:</strong> The "dumb" features are free; the "agentic" features are paid.</li>
                            </ul>
                        `
                    },
                    {
                        header: "Strategy & Moats",
                        content: `
                            <p>Does your AI product have a moat? <strong>The model itself is NOT a moat.</strong> OpenAI and Anthropic will commoditize intelligence.</p>
                            <p class="mt-4 mb-2 font-semibold text-white">The Real Moats in 2025:</p>
                            <ul class="list-disc list-inside space-y-2 text-gray-400 marker:text-gray-600">
                                <li><strong>Proprietary Data:</strong> Data that no one else has to feed into RAG.</li>
                                <li><strong>Workflow Integration:</strong> Being deeply embedded in the user's daily habits (the "System of Record").</li>
                                <li><strong>UX/Trust:</strong> The user trusts <em>your</em> agent to execute the trade/send the email.</li>
                            </ul>
                        `
                    }
                ]
            },
            "p2_fund": {
                title: "Financial Fundamentals",
                category: "Tech Finance",
                subtitle: "Speaking the language of the C-Suite and VCs.",
                sections: [
                    {
                        header: "Valuation Metrics",
                        content: `
                            <p>To talk to Execs, you must speak Finance. The most common metric for SaaS is the <strong>Rule of 40</strong>.</p>
                            <div class="bg-white/5 p-5 rounded-xl border border-white/10 my-4">
                                <strong class="text-white block mb-2">Rule of 40 Formula</strong>
                                <span class="text-gray-300 font-mono text-sm">Growth Rate (%) + Profit Margin (%) â‰¥ 40</span>
                                <p class="text-xs text-gray-500 mt-2">Example: If you grow 100% YoY, you can burn 60% margin (unprofitable) and still be "healthy" (100 - 60 = 40).</p>
                            </div>
                            <p><strong>EV/EBITDA:</strong> Used for mature companies. Enterprise Value divided by Earnings Before Interest, Taxes, Depreciation, Amortization. It roughly means "how many years of current profit would it take to buy the company?"</p>
                        `
                    },
                    {
                        header: "Equity & Cap Tables",
                        content: `
                            <p>Understanding your comp package requires knowing the difference between <strong>Preferred</strong> and <strong>Common</strong> stock.</p>
                            <ul class="list-disc list-inside space-y-3 mt-4 text-gray-400 marker:text-gray-600">
                                <li><strong>Liquidation Preference:</strong> Investors (Preferred) usually get paid back 1x their money <em>before</em> employees (Common) see a dime. In a "down round" or poor exit, employees can end up with $0 even if the company sells for millions.</li>
                                <li><strong>409A Valuation:</strong> The "Fair Market Value" of the stock, determined by a third party. This sets the "Strike Price" for your options. You want this to be low (for cheap buy-in) while the investor valuation is high.</li>
                            </ul>
                        `
                    }
                ]
            },
            "p2_econ": {
                title: "Company Economics",
                category: "Tech Finance",
                subtitle: "SaaS and Marketplace unit economics.",
                sections: [
                    {
                        header: "SaaS Metrics Deep Dive",
                        content: `
                            <p><strong class="text-white">NDR (Net Dollar Retention):</strong> The holy grail. If you stopped acquiring new customers today, would your revenue grow or shrink? <br><em class="text-gray-500">Calculation: (Starting ARR + Upgrades - Downgrades - Churn) / Starting ARR.</em> <br>Top tier companies have >120% NDR.</p>
                            <p class="mt-4"><strong class="text-white">CAC Payback Period:</strong> How many months of paying us does it take for a customer to pay back the cost of the Sales & Marketing used to get them? <br><em class="text-gray-500">Target: < 12 months for SMB, < 18 months for Enterprise.</em></p>
                        `
                    },
                    {
                        header: "Marketplace Metrics",
                        content: `
                            <p>Marketplaces (Uber, Airbnb) live and die by <strong>Liquidity</strong> (the probability of a match). High liquidity creates a flywheel.</p>
                            <p class="mt-4"><strong class="text-white">Take Rate:</strong> The % the platform keeps. App Store is 30% (High). Uber is ~25%. Marketplaces with lower take rates often defend against "disintermediation" (users taking the deal off-platform) better.</p>
                        `
                    }
                ]
            },
            "p2_invest": {
                title: "Investment Landscape",
                category: "Tech Finance",
                subtitle: "VC Dynamics and The Power Law.",
                sections: [
                    {
                        header: "The Power Law",
                        content: `
                            <p>Venture Capital is driven by the <strong>Power Law</strong>. Returns are not normally distributed.</p>
                            <div class="bg-gradient-to-r from-purple-900/40 to-blue-900/40 border border-white/10 p-5 rounded-xl my-4">
                                <p class="mb-0 text-white">In a fund of 100 companies, 1 company will likely return the entire value of the fund. 5 will do okay. 94 will fail or break even.</p>
                            </div>
                            <p>This explains VC behavior: They swing for home runs (100x returns) and ignore singles (3x returns). As a founder or PM, you need to articulate how your product can become a "fund returner" (Billion dollar outcome).</p>
                        `
                    },
                    {
                        header: "Major Players",
                        content: `
                            <p><strong class="text-white">Sequoia:</strong> The gold standard. Known for "market making" and sticking with companies for decades (Apple, Google, Nvidia).</p>
                            <p><strong class="text-white">Andreessen Horowitz (a16z):</strong> The "Agency" model. They provide massive operational support (marketing, talent) but take high fees. Famous for "Software is Eating the World."</p>
                            <p><strong class="text-white">Tiger Global:</strong> The "Velocity" model. They invest fast, do less diligence, and pay high prices, treating startups like an index fund asset class.</p>
                        `
                    }
                ]
            },
            "p2_read": {
                title: "Reading the Ecosystem",
                category: "Tech Finance",
                subtitle: "Sources, Signals, and Earnings Calls.",
                sections: [
                    {
                        header: "Sources & Signals",
                        content: `
                            <p><strong class="text-white">Stratechery (Ben Thompson):</strong> Essential for "Aggregation Theory" and platform strategy.</p>
                            <p><strong class="text-white">The Information:</strong> The best source for org-chart drama and actual revenue numbers (before they are public).</p>
                            <p><strong class="text-white">Hacker News (Y Combinator):</strong> The raw sentiment of the engineering class. If you want to know if a dev tool is actually good, look here, not on Gartner.</p>
                        `
                    },
                    {
                        header: "Earnings Calls",
                        content: `
                            <p>Don't just look at the stock price. Read the <strong>Transcript</strong>. Look for "Guidance" (what they predict for next quarter). <br>If a company beats earnings (made more money than expected) but lowers guidance (expects to make less next time), the stock will crash. Markets trade on the <em>future</em>, not the past.</p>
                        `
                    }
                ]
            },
            "p2_conv": {
                title: "The Tech Conversation",
                category: "Tech Finance",
                subtitle: "Interview prep and contrarian takes.",
                sections: [
                    {
                        header: "Interview & Networking",
                        content: `
                            <p><strong class="text-white">The Contrarian Take:</strong> In interviews, you will often be asked "What do you believe that few others do?" (Thiel question). <br><em>Good Answer Strategy:</em> Pick a structural shift. "I believe LLMs will make the 'Seat-based' SaaS pricing model obsolete by 2026, forcing a shift to outcome-based billing."</p>
                            <p class="mt-4"><strong class="text-white">Case Math:</strong> PM interviews often ask for estimation. "How much storage does Gmail need?" <br><em>Tip:</em> Memorize the powers of 10. <br>1 Million users x 1 GB = 1 Petabyte. <br>Knowing your "Tech Finance" numbers (AWS costs, storage costs) makes you look like a CTO-level thinker.</p>
                        `
                    }
                ]
            }
        };

        // --- APPLICATION LOGIC ---

        const navContainer = document.getElementById('nav-container');
        const contentArea = document.getElementById('content-area');
        const headerTitle = document.getElementById('header-title');
        const headerSubtitle = document.getElementById('header-subtitle');
        const sectionCounter = document.getElementById('section-counter');
        const globalPercent = document.getElementById('global-percent');
        const globalBar = document.getElementById('global-bar');
        const menuBtn = document.getElementById('menu-btn');
        const sidebar = document.getElementById('sidebar');

        let activeKey = null;

        function init() {
            renderNav();
            const firstKey = Object.keys(fullContent)[0];
            loadSection(firstKey);
            updateProgress();
        }

        function renderNav() {
            let currentCategory = "";
            let html = "";
            
            for (const [key, data] of Object.entries(fullContent)) {
                if (data.category !== currentCategory) {
                    html += `<div class="px-3 mt-6 mb-2 text-[10px] font-bold text-gray-500 uppercase tracking-widest">${data.category}</div>`;
                    currentCategory = data.category;
                }
                html += `
                    <div id="nav-${key}" class="nav-item group flex items-center justify-between px-3 py-2.5 rounded-lg cursor-pointer transition-all hover:bg-white/5" onclick="loadSection('${key}')">
                        <span class="text-sm font-medium text-gray-400 group-hover:text-white transition-colors">${data.title}</span>
                        <div class="h-1.5 w-1.5 rounded-full bg-transparent" id="dot-${key}"></div>
                    </div>
                `;
            }
            navContainer.innerHTML = html;
        }

        window.loadSection = (key) => {
            activeKey = key;
            const data = fullContent[key];
            
            // Highlight Nav
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            document.getElementById(`nav-${key}`).classList.add('active');

            // Set Header
            headerTitle.innerText = data.title;
            headerSubtitle.innerText = data.subtitle;

            // Render Content
            let html = `
                <div class="mb-12 animate-slide-up">
                    <h1 class="text-4xl md:text-5xl font-extrabold text-white mb-4 tracking-tight">${data.title}</h1>
                    <p class="text-xl text-gray-400 font-light">${data.subtitle}</p>
                </div>
            `;

            data.sections.forEach((section, index) => {
                const itemId = `chk_${key}_${index}`;
                const isChecked = localStorage.getItem(itemId) === 'true';

                html += `
                    <div class="glass-card rounded-2xl p-6 md:p-8 mb-8 animate-slide-up" style="animation-delay: ${index * 0.1}s">
                        <div class="flex items-start justify-between mb-6 border-b border-white/5 pb-4">
                            <h2 class="text-2xl font-bold text-white m-0">${section.header}</h2>
                            
                            <button onclick="toggleRead('${itemId}')" id="btn-${itemId}" 
                                class="flex items-center space-x-2 px-3 py-1.5 rounded-full border transition-all duration-300 ${isChecked ? 'bg-accent/20 border-accent text-accent' : 'bg-transparent border-gray-700 text-gray-500 hover:border-gray-500'}">
                                <span class="text-xs font-bold tracking-wide">${isChecked ? 'MASTERED' : 'MARK READ'}</span>
                                ${isChecked ? 
                                    '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>' : 
                                    '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>'
                                }
                            </button>
                        </div>
                        <div class="prose prose-invert prose-lg max-w-none">
                            ${section.content}
                        </div>
                    </div>
                `;
            });

            contentArea.innerHTML = html;
            
            // Scroll top
            document.querySelector('main').scrollTop = 0;
            
            // Mobile: Close sidebar
            sidebar.classList.remove('open');
            
            updateSectionProgress();
        };

        window.toggleRead = (id) => {
            const currentState = localStorage.getItem(id) === 'true';
            localStorage.setItem(id, !currentState);
            
            // Re-render button state immediately without full reload for smoothness
            const btn = document.getElementById(`btn-${id}`);
            const isChecked = !currentState;
            
            if(isChecked) {
                btn.className = "flex items-center space-x-2 px-3 py-1.5 rounded-full border transition-all duration-300 bg-accent/20 border-accent text-accent";
                btn.innerHTML = `<span class="text-xs font-bold tracking-wide">MASTERED</span><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>`;
            } else {
                btn.className = "flex items-center space-x-2 px-3 py-1.5 rounded-full border transition-all duration-300 bg-transparent border-gray-700 text-gray-500 hover:border-gray-500";
                btn.innerHTML = `<span class="text-xs font-bold tracking-wide">MARK READ</span><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>`;
            }

            updateProgress();
            updateSectionProgress();
        };

        function updateSectionProgress() {
            if (!activeKey) return;
            const data = fullContent[activeKey];
            let total = data.sections.length;
            let checked = 0;
            
            data.sections.forEach((_, index) => {
                if (localStorage.getItem(`chk_${activeKey}_${index}`) === 'true') checked++;
            });
            
            sectionCounter.innerText = `${checked}/${total}`;
            
            // Update Nav Dot logic
            const allNavs = Object.keys(fullContent);
            allNavs.forEach(key => {
                const dot = document.getElementById(`dot-${key}`);
                if(dot) {
                    // Check if section is fully complete
                    let secTotal = fullContent[key].sections.length;
                    let secChecked = 0;
                    fullContent[key].sections.forEach((_, i) => {
                        if (localStorage.getItem(`chk_${key}_${i}`) === 'true') secChecked++;
                    });
                    
                    if(secTotal === secChecked && secTotal > 0) {
                        dot.classList.remove('bg-transparent');
                        dot.classList.add('bg-accent');
                    } else {
                        dot.classList.add('bg-transparent');
                        dot.classList.remove('bg-accent');
                    }
                }
            });
        }

        function updateProgress() {
            let total = 0;
            let checked = 0;
            
            for (const [key, data] of Object.entries(fullContent)) {
                data.sections.forEach((_, index) => {
                    total++;
                    if (localStorage.getItem(`chk_${key}_${index}`) === 'true') checked++;
                });
            }
            
            const percent = total === 0 ? 0 : Math.round((checked / total) * 100);
            globalPercent.innerText = `${percent}%`;
            globalBar.style.width = `${percent}%`;
        }

        window.resetProgress = () => {
            if(confirm('Reset all reading progress?')) {
                localStorage.clear();
                location.reload();
            }
        };

        // Mobile Menu Logic
        menuBtn.addEventListener('click', () => {
            sidebar.classList.toggle('open');
        });

        // Close sidebar on outside click
        document.addEventListener('click', (e) => {
            if (window.innerWidth < 768 && 
                !sidebar.contains(e.target) && 
                !menuBtn.contains(e.target) &&
                sidebar.classList.contains('open')) {
                sidebar.classList.remove('open');
            }
        });

        // Run
        init();

    </script>
</body>
</html>
